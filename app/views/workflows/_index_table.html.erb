<div class="autoscroll">
  <table class="list">
    <thead>
      <tr>
        <th>
        </th>
        <% @roles.each do |role| %>
          <% next unless @workflow_counts.select{|i,v| i[1]==role.id && i[2]==@workspace.id}.present? %>
          <th>
            <%= content_tag(role.builtin? ? 'em' : 'span', role.name) %>
          </th>
        <% end %>
      </tr>
    </thead>
    <tbody>
      <% @trackers.each do |tracker| -%>
      <% next unless @workflow_counts.select{|i,v| i[0]==tracker.id && i[2]==@workspace.id}.present? %>
        <tr>
          <td class="name"><%= tracker.name %></td>
          <% @roles.each do |role| -%>
          <% next unless @workflow_counts.select{|i,v| i[1]==role.id && i[2]==@workspace.id}.present? %>
            <td>
              <% count = @workflow_counts[[tracker.id, role.id, @workspace.id]] || 0 %>
              <%= link_to((count > 0 ? count : content_tag(:span, nil, :class => 'icon-only icon-not-ok')),
                {:action => 'edit', :role_id => role, :tracker_id => tracker, :workspace_id => @workspace},
                :title => l(:button_edit)) %>
            </td>
          <% end -%>
        </tr>
      <% end -%>
    </tbody>
  </table>
</div>
